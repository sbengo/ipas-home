<div class="container">
  <!--app-navbar title="Wizard"></app-navbar-->

  <mat-vertical-stepper [linear]="isLinear" #stepper>
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Fill product properties</ng-template>
        <mat-form-field>
          <input matInput placeholder="Product Name" formControlName="product" required>
        </mat-form-field>
        <mat-form-field>
          <input matInput placeholder="Models" formControlName="models" required>
        </mat-form-field>
        <mat-form-field>
          <input matInput placeholder="Description" formControlName="description" required>
        </mat-form-field>
        <div>
          <button mat-icon-button mat-button matStepperPrevious color="primary">
            <mat-icon aria-label="Example icon-button with a heart icon">arrow_back_ios</mat-icon>
          </button>
          <button mat-icon-button mat-button matStepperNext color="primary">
            <mat-icon aria-label="Example icon-button with a heart icon">arrow_forward_ios</mat-icon>
          </button>
        </div>
      </form>
    </mat-step>
    <!--GATHER-->
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Gather: Select Engine</ng-template>
        <div class="col-md-3">
          <mat-form-field>
            <mat-select #gather_engine placeholder="Engine" name="engine">
              <mat-option *ngFor="let engine of gather_engines" [value]="engine.type">
                {{engine.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-fab color="primary" (click)="addEngine('gather',gather_engine.value)">Add new Engine</button>
        </div>
        <div class="col-md-9">
          <ng-container *ngIf="gather">
            <div formArrayName="gather">
              <div class="col-md-12">
                Engines:
                <div *ngFor="let sgather of gather.controls; index as i">
                    <button mat-fab color="primary" (click)="addConfigEngine('gather',i)">Add new Config</button>
                  <mat-expansion-panel [formArrayName]="i">
                    <!--div [formArrayName]="i"-->
                    <mat-expansion-panel-header>
                      <mat-panel-title>
                        {{gather.controls[i].value.engine}}
                      </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div formArrayName="config">
                    <div *ngFor="let sgatherconfig of gather.controls[i].controls.config.controls; index as p">
                        {{p}}
                      <div [formArrayName]="p">
                        {{p}}
                      <input formControlName="name">
                      {{gather.controls[i].value.config[p] | json}}
                      </div>
                      <button mat-fab color="primary" (click)="deleteConfigEngine('gather',i, p)">Delete</button>
                      <button mat-fab color="primary" (click)="deleteConfigEngine('gather',i, p)">Set Params</button>
                      <!--/div-->
                    </div>
                    </div>
                  </mat-expansion-panel>
                </div>
              </div>
            </div>

          </ng-container>
        </div>
        <div>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <!--VISUAL-->
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Visual: Select Engine</ng-template>
        <div class="col-md-6">
          <mat-form-field>
            <mat-select #visual_engine placeholder="Engine" name="engine">
              <mat-option *ngFor="let engine of visual_engines" [value]="engine.type">
                {{engine.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          {{visual_engine.value}}
          <button mat-fab color="primary" (click)="addEngine('visual',visual_engine.value)">Add new Engine</button>
        </div>
        <div class="col-md-6">
          <ng-container *ngIf="visual">
            <div formArrayName="visual">
              <div *ngFor="let city of visual.controls; index as i">
                <div [formArrayName]="i">
                  <input formControlName="engine" [placeholder]="visual.controls[i].value.engine">
                </div>
              </div>
            </div>
          </ng-container>
        </div>
        <div>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <!--ALERT-->
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Visual: Select Engine</ng-template>
        <div class="col-md-6">
          <mat-form-field>
            <mat-select #alert_engine placeholder="Engine" name="engine">
              <mat-option *ngFor="let engine of alert_engines" [value]="engine.type">
                {{engine.name}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <button mat-fab color="primary" (click)="addEngine('alert',alert_engine.value)">Add new Engine</button>
        </div>
        <div class="col-md-3">
          <ng-container *ngIf="alert">
            <div formArrayName="alert">
              <div *ngFor="let city of alert.controls; index as i">
                <div [formArrayName]="i">
                  <input formControlName="engine" [placeholder]="alert.controls[i].value.engine">
                </div>
              </div>
            </div>
          </ng-container>
        </div>
        <div>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>


    <mat-step>
      <ng-template matStepLabel>Done</ng-template>
      You are now done. Review your definition:

      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
  </mat-vertical-stepper>


  <button>
    Close
  </button>
</div>

<span *ngIf="firstFormGroup.value">


{{firstFormGroup.value | json}}
</span>